# Tables

Tables are database objects that contain all the data in database. In tables, data is logically organized in a row-and-column format similar to a spreadsheet. Each row represents a unique record, and each column represents a field in the record. For example, a table that contains employee data for a company might contain a row for each employee and columns representing employee information such as employee number, name, address, job title, and home telephone number.
- The number of tables in a DB is limited only by the number of objects allowed in a database. A standard user-defined table can have up to 1024 columns. The number of rows in the table is limited only by the storage capacity of the server.
- You can assign properties to the table and to each column in the table to contorl the data that is allowed and other properties. For example, you can create constraints on a column to disallow null values or provide a default if a value is not specified, or you can assign a key constraint on the table that enforces uniqueness or defines a relationship between tables.
- The data in the table can be compressed either by row or by page. Data compression can allow more rows to be stored on a page.

## Types of Tables

- ### Partitioned Tables
Partitioned tables are tables whose data is horizontally divided into units which may be spread acros more than one filegroup in a database. Partitioning makes large tables or indexes more manageable by letting you access or manage subsets of data quickly and efficiently, while maintaining the integrity of the overall collection.

- ### Temporary Tables
Temporary tables are stored in **tempdb**. There are two types of temporary tables: local and global. They differ from each other in their names, their visibility, and their availability. Local temporary tables have a single number sign (#) as the first chacter of their names; they are visible only to the current connection for the user, and they are deleted when the user disconnects from the instance of SQL Server. Global temporary tables have two number signs (##) as the first characters of their names; they are visible to any user after they are created, and they are deleted when all users referencing the table disconnect from the instance of SQL Server.

- ### System Tables
SQL Server stores the data that defines the configuration of the server and all its tables in a special set of tables known as system tables. Users cannot directly query of update the system tables. The information in the system tables is made available through the system views.


## Primary Keys

Primary keys and foreign keys are two types of constraints that can be used to enforce data integrigy in SQL Server tables. These are important database objects.

### Primary Key Constraints

A table typically has a column or combination of columns that contain values that uniquely identify each row in the table. This column, or columns, is called the primary key (PR) of the table and enforces the entity integrity of the table. Because primary key constraints guarantee unique data, they are frequently defined on an identiy column.

When you specify a primary key constraint for a table, the Database Engine enforces data uniqueness by automatically creating a unique index for the primary key columns. This index also permits fast access to data when the primary key is used in queries. If a primary key constraint is defined on more than one column, values may be duplicated within one column, but each combination of values from all columns in the primary key constraint definition must be unique.

- A table can contain only one primary key constraint.
- A PK cannot exceed 16 columns and a total key length of 900 bytes.
- The index generated by a PK constraint cannot cause the number of indexes on the table to exceed 999 nonclustered indexes and 1 clustered index.
- If clustered or nonclustered is not specified for a primary key constraint, clustered is used if there is no clustered inxed on the table.
- A columns defined within a PK constraint must be defined as not null. If nullability is not specified, all columns participating in a primary key constraint have their nullability set to not null.
- If a PK is defined on a CLR user-defined type column, the implementation of the type must support binary ordering.

### Foreign Key Constraints

A foreign key (FK) is ac column of combination of columns that is used to establish and enforce a link between the data in two tables to control the data that can be stored in the foreign key table. In a foreign key reference, a link is created between two tables when the column or columns that hold the primary key value for one table are referenced by the column or columns in another table. This column becomes a foreign key in the second table.

A table can reference a maximum of 253 other tables and columns as FKs (outgoing references). Restrictions:

- Greater than 253 FK references are only supported for DELETE DML operations. UPDATE and MERGE operations are not supported.
- A table with a FK reference to itself is still limited to 253 foreign key reference.
- Greater that 253 FK references are not currently available for columnstore indexes, memory-optimized tables, Stretch DB, or partitioned FK tables.


## SQL Table Statements

- ### CREATE TABLE
SQL CREATE TABLE statement is used to create table in DB. If you want to create a table, you should name the table and define its column and each columns's data type.
```
create table "tablename"  
("column1" "data type",  
"column2" "data type",  
"column3" "data type",  
...  
"columnN" "data type");  
```
#### ***Create a table using another table***
We can create a copy of an existing table using the create table command. The new table gets the same column signature as the old table. We can select all columns or some specific columns. If we create a new table using an old table, the new table will be filled with the existing calue from the old table.

The basic syntax for creating a table with the other table is:
```
CREATE TABLE table_name  AS
SELECT column1, column2,...
FROM old_table_name WHERE ...;
```

- ### DROP TABLE
A SQL DROP TABLE statement is used to delete a table definition and all data from a table. This is very important to know that once a table is deleted all the information available in the table is lost forever, so we have to be very careful when using this command.

Let's see the syntax to drop the table from the DB.
```
DROP TABLE "table_name";
```

- ### DELETE TABLE
The DELETE statement is used to delete rows from a table. If you want to remove a specific row from a table you should use WHERE condition.
```
DELETE FROM table_name [WHERE condition];
```
But if you do not specify the WHERE condition it will remove all the rows from the table.
```
DELETE FROM table_name;
```

***Difference between DELETE and TRUNCATE statements***
There is slights difference between DELETE and TRUNCATE statement. The DELETE statement only deletes the rows from the table based on the condition defined by WHERE clause or delete all the rows from the table when condition is not specified. But it does not free space containing by the table. The TRUNCATE statement: it is used to delete all the rows from the table and free the containing space.

***Difference between DROP and TRUNCATE statements***
When you use the drop statement it deletes the table's row together with the table's definition so all the relationships of that table with other tables will no longer be valid.
When you drop table:
- Table structure will be dropped.
- Relationship will be dropped.
- Integrity constraints will be dropped.
- Access privileges also be dropped.

On the other hand when we TRUNCATE a table, the table structure remains the same, so you will not face any of the above problems.

- ### RENAME TABLE
```
RENAME old_table_name TO new_table_name;
```

- ### TRUNCATE TABLE
A truncate SQL statement is used to remove all rows (complete data) from a table. It is similar to the DELETE statement with no WHERE clause.
```
TRUNCATE TABLE table_name;
```
The rollback process is not possible after truncate table statement. Once you truncate a table you cannot use a flashback table statement to retrieve the content of the table.

- ### COPY TABLE
If you want to copy the data of one SQL table into another SQL table in the same SQL server, then it is possible by using the SELECT INTO statement in SQL.
```
SELECT * INTO New_table_name FROM old_table_name;  
```

- ### ALTER TABLE
The ALTER TABLE statement in SQL allows you to add, modify, and delete columns of an existing table. This statement also allows DB users to add and remove various SQL constraints on the existing tables.

***ALTER TABLE add column statement in SQL***
```
ALTER TABLE table_name ADD column_name column-definition;
```

***ALTER TABLE modify column statement in SQL***
```
ALTER TABLE table_name MODIFY column_name column-definition;
```

***ALTER TABLE drop column statement in SQL***
```
ALTER TABLE table_name DROP Column column_name;
```

***ALTER TABLE rename column statement in SQL***
```
ALTER TABLE table_name RENAME COLUMN old_name to new_name;
```